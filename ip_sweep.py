from scapy.all import *
from scapy.layers.inet import IP, ICMP
from ipaddress import IPv4Network
from scapy.all import ICMP, IP, sr1, TCP


# IP Sweep
logging.getLogger("scapy.runtime").setLevel(logging.ERROR)
TIMEOUT = 2
conf.verb = 0

print("IP Sweep:\nSending ICMP request to 255 addresses in network '192.168.10.*'\nThis might take a while\n\n")

answered = list()

# Sending multiple requests at the same time in order to improve speed
ans, unans = sr(IP(dst="192.168.10.1-255")/ICMP(), timeout=2)

# Iterate over the requests that were answered
for snd, rcv in ans:
    # Get the address of the host that replied
    answered.append(rcv.src)

print("done\n\n")

for answer in set(answered):
    print(f"{answer} Replied")


